# Build Tools

To customize Mobi.css, you need to be familiar with some tools.

## npm

npm is the node package manager.

We use npm to install, run scripts, manage versions.

Once cloned Mobi.css main repository or plugin/theme repos, the `package.json` descripts some avalible scripts.

The basic scripts are `npm install`, `npm start` and `npm test`:

```bash
npm install     # Install the dependencies
npm start       # Build css, js and docs. Serve public. Watch changes
npm test        # Run lint and tests
```

Other useful scripts:

```bash
npm run build   # Build css, js and docs
npm run lint    # Lint styles and scripts
npm version patch/minor/major
                # Update the version. This will run preversion and version scripts
npm publish     # Publish the current version
```

## gulp

gulp is a task runner for development.

Actually `npm start` and `npm build` are simply run gulp tasks.

## PostCSS

PostCSS is a tool for transforming styles with JS plugins. Here are some useful PostCSS plugins:

- [postcss-import](https://github.com/postcss/postcss-import): transform `@import` rules by inlining content.
- [cssnext](http://cssnext.io/): use tomorrowâ€™s CSS syntax, today.
- [Autoprefixer](https://github.com/postcss/autoprefixer): add vendor prefixes to CSS rules
- [postcss-pxtorem](https://github.com/cuth/postcss-pxtorem): convert pixel units to rem (root em) units using PostCSS
- [cssnano](http://cssnano.co/): a modern CSS compressor
- [stylefmt](https://github.com/morishitter/stylefmt): a tool that automatically formats CSS according to stylelint rules.

## stylelint

[Stylelint](https://stylelint.io/) is a mighty, modern CSS linter.

## Pagic

[Pagic](https://github.com/xcatliu/pagic) is a static site generator, most of Mobi.css docs are generated by it.

## Lerna

Because Mobi.css is made of plugins, we use [Lerna](https://github.com/lerna/lerna) to manage mulitple packages.

## mobi-util-build-css

> The build css util for Mobi.css

It combines gulp, PostCSS, sourcemap and so on.

### Getting Started

#### Installation

```bash
npm install --save-dev mobi-util-build-css
```

#### Usage

```js
const { clean, buildCSS } = require('mobi-util-build-css');

clean('dist');
// This will remove `dist` directory

buildCSS({
    src: 'src/css/file.css',
    dist: 'dist/css/file.css',
    callback: () => { console.log('Build done') }
});
// This will compile `src/css/file.css` to `dist/css/file.css` and `dist/css/file.css.map`

buildCSS({
    src: 'src/css/file.css',
    dist: 'dist/css/file.min.css',
    compress: true, // default to false
    callback: () => { console.log('Build done') }
});
// This will compile and compress `src/css/file.css` to `dist/css/file.min.css` and `dist/css/file.min.css.map`

buildCSS({
    src: 'src/css/file.css',
    dist: 'dist/css/file.min.css',
    prepend: '/*! The meta message */\n',
    callback: () => { console.log('Build done') }
});
// This will prepend the comments to yielded file. Please notice that only comments start with /*! will not be removed during compress
```
